<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OGRE: External Texture Sources</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="ogre_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ogre-logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OGRE
   &#160;<span id="projectnumber">13.6</span>
   </div>
   <div id="projectbrief">Object-Oriented Graphics Rendering Engine</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_external-_texture-_sources.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">External Texture Sources </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_tutorials_external_texture"></a> This tutorial will provide a brief introduction of ExternalTextureSource and ExternalTextureSourceManager classes, their relationship, and how the PlugIns work. For those interested in developing a Texture Source Plugin or maybe just wanting to know more about this system, take a look the <a href="https://github.com/OGRECave/ogre-audiovideo">TheoraVideoSystem Plugin</a>, which you can find more about on the OGRE forums.</p>
<p><a class="anchor" id="What-Is-An-External-Texture-Source_003f"></a></p>
<h1><a class="anchor" id="autotoc_md299"></a>
What Is An External Texture Source?</h1>
<p>What is a texture source? Well, a texture source could be anything - png, bmp, jpeg, etc. However, loading textures from traditional bitmap files is already handled by another part OGRE. There are, however, other types of sources to get texture data from - i.e. ogg/avi/etc movie files, run-time generated source, user defined, etc.</p>
<p>How do external texture source plugins benefit OGRE? Well, the main answer is: adding support for any type of texture source does not require changing OGRE to support it... all that is involved is writing a new plugin. Additionally, because the manager uses the <a class="el" href="class_ogre_1_1_string_interface.html" title="Class defining the common interface which classes can use to present a reflection-style,...">Ogre::StringInterface</a> class to issue commands/params, no change to the material script reader is needs to be made. As a result, if a plugin needs a special parameter set, it just creates a new command in itâ€™s Parameter Dictionary. - see TheoraVideoSystem plugin for an example. To make this work, two classes have been added to OGRE:</p><ul>
<li><a class="el" href="class_ogre_1_1_external_texture_source.html" title="IMPORTANT: Plugins must override default dictionary name! Base class that texture plugins derive from...">Ogre::ExternalTextureSource</a></li>
<li><a class="el" href="class_ogre_1_1_external_texture_source_manager.html" title="Singleton Class which handles the registering and control of texture plugins.">Ogre::ExternalTextureSourceManager</a></li>
</ul>
<p><a class="anchor" id="ExternalTextureSource-Class"></a></p>
<h1><a class="anchor" id="autotoc_md300"></a>
ExternalTextureSource Class</h1>
<p>The <code>ExternalTextureSource</code> class is the base class that Texture Source PlugIns must be derived from. It provides a generic framework with a very limited amount of functionality. The most common of parameters can be set through the ExternalTextureSource class interface or via the StringInterface commands contained within this class. While this may seem like duplication of code, it is not. By using the string command interface, it becomes extremely easy for derived plugins to add any new types of parameters that it may need.</p>
<p>Default Command Parameters defined in ExternalTextureSource base class are:</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>Sets a filename plugin will read from </td></tr>
    <tr><td class="paramname">play_mode</td><td>Sets initial play mode to be used by the plugin - "play", "loop", "pause" </td></tr>
    <tr><td class="paramname">set_T_P_S</td><td>Used to set the technique, pass, and texture unit level to apply this texture to. As an example: To set a technique level of 1, a pass level of 2, and a texture unit level of 3, send this string "1 2 3". </td></tr>
    <tr><td class="paramname">frames_per_second</td><td>Set a Frames per second update speed. (Integer Values only)</td></tr>
  </table>
  </dd>
</dl>
<p><a class="anchor" id="ExternalTextureSourceManager-Class"></a></p>
<h1><a class="anchor" id="autotoc_md301"></a>
ExternalTextureSourceManager Class</h1>
<p><code>ExternalTextureSourceManager</code> is responsible for keeping track of loaded Texture Source PlugIns. It also aids in the creation of texture source textures from scripts. It also is the interface you should use when dealing with texture source plugins.</p>
<p>Steps needed to create a new texture via ExternalTextureSourceManager:</p>
<dl class="section remark"><dt>Remarks</dt><dd>The function prototypes shown below are mockups - param names are simplified to better illustrate purpose here...</dd></dl>
<ul>
<li>Obviously, the first step is to have the desired plugin included in <code>plugin.cfg</code> for it to be loaded.</li>
<li>Set the desired PlugIn as Active via <div class="fragment"><div class="line"><a class="code" href="class_ogre_1_1_external_texture_source_manager.html#a48ff44556145b75d887f4162ff44237b">Ogre::ExternalTextureSourceManager::getSingleton</a>().<a class="code" href="class_ogre_1_1_external_texture_source_manager.html#a20928ae950911b85605994775e2485e1">setCurrentPlugIn</a>(type);</div>
<div class="ttc" id="aclass_ogre_1_1_external_texture_source_manager_html_a20928ae950911b85605994775e2485e1"><div class="ttname"><a href="class_ogre_1_1_external_texture_source_manager.html#a20928ae950911b85605994775e2485e1">Ogre::ExternalTextureSourceManager::setCurrentPlugIn</a></div><div class="ttdeci">void setCurrentPlugIn(const String &amp;sTexturePlugInType)</div><div class="ttdoc">Sets active plugin (ie.</div></div>
<div class="ttc" id="aclass_ogre_1_1_external_texture_source_manager_html_a48ff44556145b75d887f4162ff44237b"><div class="ttname"><a href="class_ogre_1_1_external_texture_source_manager.html#a48ff44556145b75d887f4162ff44237b">Ogre::ExternalTextureSourceManager::getSingleton</a></div><div class="ttdeci">static ExternalTextureSourceManager &amp; getSingleton(void)</div><div class="ttdoc">Get the singleton instance.</div></div>
</div><!-- fragment --> type is whatever the plugin registers as handling (e.g. "video", "flash", "whatever", etc).</li>
<li>Consult Desired PlugIn to see what params it needs/expects. Set params/value pairs via <div class="fragment"><div class="line"><a class="code" href="class_ogre_1_1_external_texture_source_manager.html#a01221254a3321182e78cbb0484f35b42">Ogre::ExternalTextureSourceManager::getCurrentPlugIn</a>()-&gt;<a class="code" href="class_ogre_1_1_string_interface.html#a08d117bf25f011f96d81f1f4ecb25113">setParameter</a>( Param, Value );</div>
<div class="ttc" id="aclass_ogre_1_1_external_texture_source_manager_html_a01221254a3321182e78cbb0484f35b42"><div class="ttname"><a href="class_ogre_1_1_external_texture_source_manager.html#a01221254a3321182e78cbb0484f35b42">Ogre::ExternalTextureSourceManager::getCurrentPlugIn</a></div><div class="ttdeci">ExternalTextureSource * getCurrentPlugIn(void) const</div><div class="ttdoc">Returns currently selected plugin, may be null if none selected.</div><div class="ttdef"><b>Definition:</b> OgreExternalTextureSourceManager.h:67</div></div>
<div class="ttc" id="aclass_ogre_1_1_string_interface_html_a08d117bf25f011f96d81f1f4ecb25113"><div class="ttname"><a href="class_ogre_1_1_string_interface.html#a08d117bf25f011f96d81f1f4ecb25113">Ogre::StringInterface::setParameter</a></div><div class="ttdeci">bool setParameter(const String &amp;name, const String &amp;value)</div><div class="ttdoc">Generic parameter setting method.</div></div>
</div><!-- fragment --></li>
<li>After required params are set, a simple call to <div class="fragment"><div class="line"><a class="code" href="class_ogre_1_1_external_texture_source_manager.html#a01221254a3321182e78cbb0484f35b42">Ogre::ExternalTextureSourceManager::getCurrentPlugIn</a>()-&gt;<a class="code" href="class_ogre_1_1_external_texture_source.html#a72f123ce494815d9871a7ab94bba5d17">createDefinedTexture</a>( MaterialName );</div>
<div class="ttc" id="aclass_ogre_1_1_external_texture_source_html_a72f123ce494815d9871a7ab94bba5d17"><div class="ttname"><a href="class_ogre_1_1_external_texture_source.html#a72f123ce494815d9871a7ab94bba5d17">Ogre::ExternalTextureSource::createDefinedTexture</a></div><div class="ttdeci">virtual void createDefinedTexture(const String &amp;sMaterialName, const String &amp;groupName=ResourceGroupManager::DEFAULT_RESOURCE_GROUP_NAME)=0</div><div class="ttdoc">Creates a texture into an already defined material or one that is created new (it's up to plugin to u...</div></div>
</div><!-- fragment --> will create a texture to the material name given.</li>
</ul>
<p>The manager also provides a method for deleting a texture source material </p><div class="fragment"><div class="line"><a class="code" href="class_ogre_1_1_external_texture_source_manager.html#ac555acdb2331964338efe376b156ff83">Ogre::ExternalTextureSourceManager::destroyAdvancedTexture</a>( MaterialName )</div>
<div class="ttc" id="aclass_ogre_1_1_external_texture_source_manager_html_ac555acdb2331964338efe376b156ff83"><div class="ttname"><a href="class_ogre_1_1_external_texture_source_manager.html#ac555acdb2331964338efe376b156ff83">Ogre::ExternalTextureSourceManager::destroyAdvancedTexture</a></div><div class="ttdeci">void destroyAdvancedTexture(const String &amp;sTextureName, const String &amp;groupName=ResourceGroupManager::DEFAULT_RESOURCE_GROUP_NAME)</div><div class="ttdoc">Calls the destroy method of all registered plugins...</div></div>
</div><!-- fragment --><p> The destroy method works by broadcasting the material name to all loaded <code>ExternalTextureSource</code> instances, and the PlugIn who actually created the material is responsible for the deletion, while other PlugIns will just ignore the request. What this means is that you do not need to worry about which PlugIn created the material, or activating the PlugIn yourself. Just call the manager method to remove the material. Also, all texture plugins should handle cleanup when they are shutdown.</p>
<p><a class="anchor" id="Texture-Source-Material-Script"></a></p>
<h1><a class="anchor" id="autotoc_md302"></a>
Texture Source Material Script</h1>
<p>As mentioned earlier, the process of defining/creating texture sources can be done within material script file. Here is an example of a material script definition - Note: This example is based off the <code>TheoraVideoSystem</code> Plugin parameters.</p>
<div class="fragment"><div class="line">material Example/MyVideoExample</div>
<div class="line">{</div>
<div class="line">    technique</div>
<div class="line">    {</div>
<div class="line">        pass</div>
<div class="line">        {</div>
<div class="line">            texture_unit</div>
<div class="line">            {</div>
<div class="line">                texture_source ogg_video</div>
<div class="line">                {</div>
<div class="line">                    filename mymovie.ogg</div>
<div class="line">                    play_mode play</div>
<div class="line">                    sound_mode on</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>Notice that the first two param/value pairs are defined in the ExternalTextureSource base class and that the third parameter/value pair is not defined in the base class... That parameter is added to the param dictionary by the <code>TheoraVideoSystem</code>... This shows that extending the functionality with the plugins is extremely easy. Also, pay particular attention to the line: <code>texture_source ogg_video</code>. This line identifies that this texture unit will come from a texture source plugin. It requires one parameter that determines which texture plugin will be used. In the example shown, the plugin requested is one that registered with <code>"ogg_video"</code> name.</p>
<p><a class="anchor" id="Simplified-Diagram-of-Process"></a></p>
<h1><a class="anchor" id="autotoc_md303"></a>
Simplified Diagram of Process</h1>
<p>This diagram uses <code>TheoraVideoSystem</code> as example, but all plug ins will work the same in how they are registered/used here. Also note that TextureSource Plugins are loaded/registered before scripts are parsed. This does not mean that they are initialized... Plugins are not initialized until they are set active! This is to ensure that a rendersystem is set up before the plugins might make a call the rendersystem.</p>
<p><img src="TextureSource.svg" alt="" style="pointer-events: none;" class="inline"/> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="tutorials.html">Tutorials</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OGRE: Resource Management</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="ogre_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ogre-logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OGRE
   &#160;<span id="projectnumber">13.6</span>
   </div>
   <div id="projectbrief">Object-Oriented Graphics Rendering Engine</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_resource-_management.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Resource Management </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#Resource-Life-cycle">Resource Life-cycle</a></li>
<li class="level1"><a href="#Resource-Location">Locations</a></li>
<li class="level1"><a href="#Resource-Groups">Groups</a><ul><li class="level2"><a href="#Resource-Declaration">Resource-Declaration</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_resourcemanagement"></a> Resources are data objects that must be loaded and managed throughout an application. A <a class="el" href="class_ogre_1_1_resource.html" title="Abstract class representing a loadable resource.">Ogre::Resource</a> might be a <a class="el" href="class_ogre_1_1_mesh.html" title="Resource holding data about 3D mesh.">Ogre::Mesh</a>, a <a class="el" href="class_ogre_1_1_texture.html" title="Abstract class representing a Texture resource.">Ogre::Texture</a>, or any other piece of data - the key properties are</p><ul>
<li>they must be identified by a name which is unique</li>
<li>must be loaded only once</li>
<li>must be managed efficiently in terms of retrieval, and</li>
<li>they may also be unloadable to free memory up when they have not been used for a while and the memory budget is under stress.</li>
</ul>
<h1><a class="anchor" id="Resource-Life-cycle"></a>
Resource Life-cycle</h1>
<p><img src="ResourceManagement.svg" alt="" style="pointer-events: none;" class="inline"/></p>
<p>A <a class="el" href="class_ogre_1_1_resource_manager.html" title="Defines a generic resource handler.">Ogre::ResourceManager</a> is responsible for managing a pool of resources of a particular type. It must index them, look them up, load and destroy them. It may also need to stay within a defined memory budget, and temporarily unload some resources if it needs to to stay within this budget.</p>
<p>Resource managers use a priority system to determine what can be unloaded, and a Least Recently Used (LRU) policy within resources of the same priority.</p>
<p>Resources can be loaded using the generalised load interface, and they can be unloaded and removed. In addition, each subclass of ResourceManager will likely define custom 'load' methods which take explicit parameters depending on the kind of resource being created.</p>
<p>A resource is created in <a class="el" href="class_ogre_1_1_resource.html#a07e619aa09d3bc6789a6667cb4fc572ca28d463296cacdfc115dbc3fb02d00e94">LOADSTATE_UNLOADED</a>, it then progressed to <a class="el" href="class_ogre_1_1_resource.html#a07e619aa09d3bc6789a6667cb4fc572ca133a073b86c346096237063f99870fc1">LOADSTATE_PREPARED</a>, the meaning of which depends on the concrete Resource type, but usually means that data has been read from disk into memory. <a class="el" href="class_ogre_1_1_resource.html#a07e619aa09d3bc6789a6667cb4fc572caa38cbef7605fc4bff6da2f34599ace8f">LOADSTATE_LOADED</a> means all data has been uploaded to the GPU and is ready to use without further processing.</p>
<p>Resources can be loaded and unloaded through the <a class="el" href="class_ogre_1_1_resource.html" title="Abstract class representing a loadable resource.">Ogre::Resource</a> class, but they can only be removed (and thus eventually destroyed) using their parent <a class="el" href="class_ogre_1_1_resource_manager.html" title="Defines a generic resource handler.">Ogre::ResourceManager</a>.</p>
<dl class="section note"><dt>Note</dt><dd>specify a <a class="el" href="class_ogre_1_1_manual_resource_loader.html" title="Interface describing a manual resource loader.">Ogre::ManualResourceLoader</a> for procedurally generated Resources at creation time, so they can be unloaded/ reloaded too.</dd></dl>
<h1><a class="anchor" id="Resource-Location"></a>
Locations</h1>
<p>Resource files need to be loaded from specific locations. By calling <a class="el" href="class_ogre_1_1_resource_group_manager.html#a6ff0efec5d27cedb448cfba8b2b78c8d" title="Adds a location to the list of searchable locations for a Resource type.">Ogre::ResourceGroupManager::addResourceLocation</a>, you add search locations to the list. Locations added first are preferred over locations added later. Furthermore locations are indexed at the time you add them, so make sure that all your assets are already there - or you will have to remove and re-add the location.</p>
<p>Locations can be folders, compressed archives, even perhaps remote locations. Facilities for loading from different locations are provided by plugins which provide implementations of the <a class="el" href="class_ogre_1_1_archive.html" title="Archive-handling class.">Ogre::Archive</a> class. All the application user has to do is specify a 'loctype' string in order to indicate the type of location, which should map onto one of the provided plugins. Ogre comes configured with the <code>FileSystem</code> (folders) and <code>Zip</code> (archive compressed with the pkzip / WinZip etc utilities) types.</p>
<h1><a class="anchor" id="Resource-Groups"></a>
Groups</h1>
<p>Resource Locations are organized in Groups. A resource group allows you to define a set of resources that can be loaded / unloaded as a unit. For example, it might be all the resources used for the level of a game.</p><ul>
<li>There is always one predefined resource group called "General", which is typically used to hold all resources which do not need to be unloaded until shutdown.</li>
<li>There is another predefined resource group called <a class="el" href="class_ogre_1_1_resource_group_manager.html#a0f8745290121d5d9b612d9336c465f62">INTERNAL_RESOURCE_GROUP_NAME</a> too, which should be used by OGRE internal only, the resources created in this group aren't supposed to be modified, unloaded or removed by user.</li>
<li>There is one other predefined value, <a class="el" href="class_ogre_1_1_resource_group_manager.html#a2a3698b4303d782938455e649b2e22a2">AUTODETECT_RESOURCE_GROUP_NAME</a>. Using this causes to search for the resource in the resource locations of each group in turn. The results depends on the set of defined groups as the same resource name might exist in several groups.</li>
</ul>
<p>You can create additional groups so that you can control the life of your resources in whichever way you wish.</p>
<p>Once you have defined a resource group, resources which will be loaded as part of it are defined in one of 2 ways:</p>
<ol type="1">
<li>Through the use of <a class="el" href="_scripts.html">Scripts</a>; some <a class="el" href="class_ogre_1_1_resource_manager.html" title="Defines a generic resource handler.">Ogre::ResourceManager</a> subtypes have script formats (e.g. .material, .overlay) which can be used to declare resources</li>
<li>By calling <a class="el" href="class_ogre_1_1_resource_manager.html#a700088a63eabb0f6cb1fac96686db464" title="Creates a new blank resource, but does not immediately load it.">Ogre::ResourceManager::createResource</a> to create a resource manually. This resource will go on the list for it's group and will be loaded and unloaded with that group</li>
</ol>
<p>After creating a resource group, adding some resource locations, and perhaps <a class="el" href="_resource-_management.html#Resource-Declaration">pre-declaring</a> some resources, but before you need to use the resources in the group, you must call <a class="el" href="class_ogre_1_1_resource_group_manager.html#af5c901bfb116d7f70f4542bd828784f4" title="Initialises a resource group.">Ogre::ResourceGroupManager::initialiseResourceGroup</a> to initialise the group. By calling this, you are triggering the following processes:</p>
<ul>
<li><a class="el" href="_scripts.html">Scripts</a> for all resource types which support scripting are parsed from the resource locations, and resources within them are created (but not loaded yet).</li>
<li>Creates all the resources which have just pre-declared using declareResource (again, these are not loaded yet)</li>
</ul>
<p>So what this essentially does is create a bunch of unloaded <a class="el" href="class_ogre_1_1_resource.html" title="Abstract class representing a loadable resource.">Ogre::Resource</a> objects in the respective ResourceManagers based on scripts, and resources you've pre-declared. That means that code looking for these resources will find them, but they won't be taking up much memory yet, until they are either used, or they are loaded in bulk using <a class="el" href="class_ogre_1_1_resource_group_manager.html#ae01e1cd42ad060adbeeddd5c500ac8c8" title="Loads a resource group.">Ogre::ResourceGroupManager::loadResourceGroup</a>. Loading the resource group in bulk is entirely optional, but has the advantage of coming with progress reporting as resources are loaded.</p>
<p>Failure to call <a class="el" href="class_ogre_1_1_resource_group_manager.html#af5c901bfb116d7f70f4542bd828784f4" title="Initialises a resource group.">Ogre::ResourceGroupManager::initialiseResourceGroup</a> means that <a class="el" href="class_ogre_1_1_resource_group_manager.html#ae01e1cd42ad060adbeeddd5c500ac8c8" title="Loads a resource group.">Ogre::ResourceGroupManager::loadResourceGroup</a> will do nothing, and any resources you define in scripts will not be found. Similarly, once you have called this method you won't be able to pick up any new scripts or pre-declared resources, unless you call <a class="el" href="class_ogre_1_1_resource_group_manager.html#a7046808e2a8caf92e19907e5d9c310fd" title="Clears a resource group.">Ogre::ResourceGroupManager::clearResourceGroup</a>, set up declared resources, and call this method again.</p>
<dl class="section note"><dt>Note</dt><dd>Resource groups by default are treated as self-contained - i.e. they cannot reference resources from other groups. To circumvent this specify <code>inGlobalPool=true</code> at <a class="el" href="class_ogre_1_1_resource_group_manager.html#a9c1ba0f11d134d0b5614391ca836844c" title="Create a resource group.">Ogre::ResourceGroupManager::createResourceGroup</a> for all groups that should be able to cross-reference resources.</dd></dl>
<h2><a class="anchor" id="Resource-Declaration"></a>
Resource-Declaration</h2>
<p>Declaring the resources you intend to use in advance is optional, however it is a very useful feature. By declaring resources before you attempt to use them, you can more easily control the loading and unloading of those resources by their group. Declaring them also allows them to be enumerated, which means events can be raised to indicate the loading progress (<a class="el" href="class_ogre_1_1_resource_group_listener.html" title="This class defines an interface which is called back during resource group loading to indicate the pr...">Ogre::ResourceGroupListener</a>).</p>
<p>To declare a resource use <a class="el" href="class_ogre_1_1_resource_group_manager.html#a1c684fc288dcdeeeeee7c10971c3af43" title="Declares a resource to be a part of a resource group, allowing you to load and unload it as part of t...">Ogre::ResourceGroupManager::declareResource</a>. This is useful for scripted declarations since it is entirely generalised, and does not create Resource instances right away. This adds the following conceptual stages before a Resource is created as Unloaded:</p>
<dl class="section user"><dt>Undefined</dt><dd>Nobody knows about this resource yet. It might be in the filesystem, but Ogre is oblivious to it at the moment - there is no <a class="el" href="class_ogre_1_1_resource.html" title="Abstract class representing a loadable resource.">Ogre::Resource</a> instance. This might be because it's never been declared (either in a script, or using <a class="el" href="class_ogre_1_1_resource_group_manager.html#a1c684fc288dcdeeeeee7c10971c3af43" title="Declares a resource to be a part of a resource group, allowing you to load and unload it as part of t...">Ogre::ResourceGroupManager::declareResource</a>), or it may have previously been a valid Resource instance but has been removed, either individually through <a class="el" href="class_ogre_1_1_resource_manager.html#a257ae8a9ac7538581173b7ddcf7b3f19" title="Remove a single resource.">Ogre::ResourceManager::remove</a> or as a group through <a class="el" href="class_ogre_1_1_resource_group_manager.html#a7046808e2a8caf92e19907e5d9c310fd" title="Clears a resource group.">Ogre::ResourceGroupManager::clearResourceGroup</a>.</dd></dl>
<dl class="section user"><dt>Declared</dt><dd>Ogre has some forewarning of this resource, either through calling <a class="el" href="class_ogre_1_1_resource_group_manager.html#a1c684fc288dcdeeeeee7c10971c3af43" title="Declares a resource to be a part of a resource group, allowing you to load and unload it as part of t...">Ogre::ResourceGroupManager::declareResource</a>, or by declaring the resource in a script file which is on one of the resource locations which has been defined for a group. There is still no instance of Resource, but <a class="el" href="namespace_ogre.html">Ogre</a> will know to create this resource when <a class="el" href="class_ogre_1_1_resource_group_manager.html#af5c901bfb116d7f70f4542bd828784f4" title="Initialises a resource group.">Ogre::ResourceGroupManager::initialiseResourceGroup</a> is called (which is automatic if you declare the resource group before <a class="el" href="class_ogre_1_1_root.html#a6ab8f204bbfb150ad180eb6e78e4639c" title="Initialises the renderer.">Ogre::Root::initialise</a>).</dd></dl>
<dl class="section user"><dt>Unloaded</dt><dd>There is now a <a class="el" href="class_ogre_1_1_resource.html" title="Abstract class representing a loadable resource.">Ogre::Resource</a> instance for this resource, although it is not loaded. This means that code which looks for this named resource will find it, but the Resource is not using a lot of memory because it is in an unloaded state. A Resource can get into this state by having just been created by <a class="el" href="class_ogre_1_1_resource_group_manager.html#af5c901bfb116d7f70f4542bd828784f4" title="Initialises a resource group.">Ogre::ResourceGroupManager::initialiseResourceGroup</a> (either from a script, or from a call to <a class="el" href="class_ogre_1_1_resource_group_manager.html#a1c684fc288dcdeeeeee7c10971c3af43" title="Declares a resource to be a part of a resource group, allowing you to load and unload it as part of t...">Ogre::ResourceGroupManager::declareResource</a>), by being created directly from code (<a class="el" href="class_ogre_1_1_resource_manager.html#a700088a63eabb0f6cb1fac96686db464" title="Creates a new blank resource, but does not immediately load it.">Ogre::ResourceManager::createResource</a>), or it may have previously been loaded and has been unloaded, either individually through Resource::unload, or as a group through <a class="el" href="class_ogre_1_1_resource_group_manager.html#a01166a19f261e9b4fd2908c94c829d08" title="Unloads a resource group.">Ogre::ResourceGroupManager::unloadResourceGroup</a>. </dd></dl>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="manual.html">Manual</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
